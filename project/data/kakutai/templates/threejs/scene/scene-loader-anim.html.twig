<script>

// anims is a global table for looking up available character animations
function loadSeerAnimation( animpath, animname, loaderReady ) {
    
    // Get the animations - we dont really care about the models.
    var loader = new THREE.GLTFLoader();
    // Optional: Provide a DRACOLoader instance to decode compressed mesh data
    THREE.DRACOLoader.setDecoderPath( '{{ theme_url }}/assets/js/threejs/libs/draco' );
    loader.setDRACOLoader( new THREE.DRACOLoader() );
    loader.load( animpath, function( asset ) {

        anims[animname] = { anim: asset.animations[0] };
        loaderReady( anims[animname] );
    });
}

function animateObject( mesh, animname ) {

    // Get correct animation for mesh type - ie female anim for female mesh.
    var fullanim = animname + "-male";
    if(mesh.userData.filename.indexOf( "-female" ) > -1 ) {
        fullanim = animname + "-female";
    }

    animplayers[mesh.uuid] = { mixer: 0, action: 0 };
    animplayers[mesh.uuid].mixer = new THREE.AnimationMixer( mesh );
    animplayers[mesh.uuid].action = animplayers[mesh.uuid].mixer.clipAction( anims[fullanim].anim );
    animplayers[mesh.uuid].action.play();
}

function updateAnims( delta ) {
    
    for (var property in animplayers) {
        if (animplayers.hasOwnProperty(property)) {
            // do stuff
            var obj = animplayers[property];
            if( obj.mixer != 0) obj.mixer.update(delta);
        }
    }
}

</script>